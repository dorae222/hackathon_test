<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ì¶”ì²œ ê°•ì•„ì§€ ê²°ê³¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap');
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f7f2ea;
            color: #4a2c2a;
        }
        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        /* â˜…â˜…â˜…â˜…â˜… 4. ìŠ¬ë¼ì´ë” ë²„íŠ¼ ìƒ‰ìƒ ìŠ¤íƒ€ì¼ ì¶”ê°€ â˜…â˜…â˜…â˜…â˜… */
        .swiper-button-next, .swiper-button-prev {
            top: 40%;
            color: #bf7676; /* ì‚¬ì´íŠ¸ ë©”ì¸ ì»¬ëŸ¬ë¡œ ë³€ê²½ */
        }
    </style>
</head>
<body class="bg-[#f7f2ea]">

    <header class="bg-[#f0d8b6] p-4">
        </header>

    <main class="container mx-auto py-16 px-4">
        <h1 class="text-4xl font-extrabold text-center text-[#4a2c2a] mb-4">
            AIê°€ ì°¾ì•„ë‚¸ íšŒì›ë‹˜ì˜ ë‹®ì€ê¼´ ê°•ì•„ì§€ í’ˆì¢… Top 3! ğŸ¶
        </h1>
        <p class="text-center text-[#7a574b] text-lg mb-12 max-w-2xl mx-auto">
            ì—…ë¡œë“œí•´ì£¼ì‹  ì‚¬ì§„ì„ ë°”íƒ•ìœ¼ë¡œ AIê°€ ë¶„ì„í•œ ê²°ê³¼, íšŒì›ë‹˜ê³¼ ê°€ì¥ ë‹®ì€ í’ˆì¢…ë“¤ì…ë‹ˆë‹¤.
        </p>

        <div id="top3" class="flex flex-col md:flex-row justify-center items-stretch gap-8 w-full max-w-6xl mx-auto mb-16"></div>
        
        <hr class="my-16 border-t-2 border-[#f0d8b6] w-full max-w-6xl mx-auto">

        <h2 class="text-3xl font-bold text-center text-[#4a2c2a] mb-8">íšŒì›ë‹˜ì˜ ë¼ì´í”„ìŠ¤íƒ€ì¼ì— ë§ëŠ” ì¹œêµ¬ë“¤ë„ ì¶”ì²œí•´ìš”! ğŸ¶â¤ï¸</h2>
        
        <div class="w-full max-w-6xl mx-auto relative">
            <div class="swiper">
                <div id="animal-swiper-wrapper" class="swiper-wrapper">
                    <div class="swiper-slide h-auto pb-4">
                        <div class="bg-white rounded-2xl overflow-hidden card-shadow transform hover:-translate-y-2 transition duration-300 h-full flex flex-col">
                            <img src="https://placedog.net/640/480/g" alt="ê°•ì•„ì§€ ì‚¬ì§„" class="w-full h-56 object-cover">
                            <div class="p-6 flex flex-col flex-grow">
                                <h3 class="text-2xl font-bold text-[#4a2c2a] mb-2">ì½©ì´</h3>
                                <div class="flex flex-wrap gap-2 mb-4">
                                    <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">ë¯¹ìŠ¤ê²¬</span>
                                    <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">2ì‚´ ì¶”ì •</span>
                                    <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">ì•”ì»·</span>
                                </div>
                                <div class="bg-[#f0d8b6] p-3 rounded-lg mb-4">
                                    <p class="text-sm text-[#4a2c2a] font-semibold">ğŸ’¡ <strong>AI ì¶”ì²œ ì´ìœ :</strong> ë°˜ë ¤ ê²½í—˜ì´ ìˆëŠ” ë¶„ì—ê²Œ ì í•©í•˜ë©°, í•˜ë£¨ 1ì‹œê°„ ì´ìƒ ì‚°ì±…ì´ ê°€ëŠ¥í•œ í™œë™ì ì¸ ê°€ì¡±ì—ê²Œ ìµœê³ ì˜ ì¹œêµ¬ê°€ ë  ê±°ì˜ˆìš”!</p>
                                </div>
                                <button href="chatbot.html" class="w-full mt-auto bg-[#a9754f] hover:bg-[#7a574b] text-white font-bold py-2 px-4 rounded-full transition duration-300">ìì„¸íˆ ë³´ê¸°</button>
                            </div>
                        </div>
                    </div>
                    <div class="swiper-slide h-auto pb-4">
                        <div class="bg-white rounded-2xl overflow-hidden card-shadow transform hover:-translate-y-2 transition duration-300 h-full flex flex-col">
                            <img src="https://placedog.net/640/480/r" alt="ê°•ì•„ì§€ ì‚¬ì§„" class="w-full h-56 object-cover">
                            <div class="p-6 flex flex-col flex-grow">
                                <h3 class="text-2xl font-bold text-[#4a2c2a] mb-2">ë°¤í†¨ì´</h3>
                                <div class="flex flex-wrap gap-2 mb-4">
                                    <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">ì§„ë„ë¯¹ìŠ¤</span>
                                    <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">8ê°œì›” ì¶”ì •</span>
                                    <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">ìˆ˜ì»·</span>
                                </div>
                                <div class="bg-[#f0d8b6] p-3 rounded-lg mb-4">
                                     <p class="text-sm text-[#4a2c2a] font-semibold">ğŸ’¡ <strong>AI ì¶”ì²œ ì´ìœ :</strong> ì•„íŒŒíŠ¸/ë¹Œë¼ í™˜ê²½ì— ì˜ ì ì‘í•  ìˆ˜ ìˆê³ , ê°•ì•„ì§€ë¥¼ ì²˜ìŒ í‚¤ìš°ì‹œëŠ” ë¶„ë„ ì‰½ê²Œ êµê°í•  ìˆ˜ ìˆëŠ” ë˜‘ë˜‘í•œ ì¹œêµ¬ì…ë‹ˆë‹¤.</p>
                                </div>
                                <button href="chatbot.html" class="w-full mt-auto bg-[#a9754f] hover:bg-[#7a574b] text-white font-bold py-2 px-4 rounded-full transition duration-300">ìì„¸íˆ ë³´ê¸°</button>
                            </div>
                        </div>
                    </div>
                    <div class="swiper-slide h-auto pb-4">
                         <div class="bg-white rounded-2xl overflow-hidden card-shadow transform hover:-translate-y-2 transition duration-300 h-full flex flex-col">
                            <img src="https://placedog.net/640/480/b" alt="ê°•ì•„ì§€ ì‚¬ì§„" class="w-full h-56 object-cover">
                            <div class="p-6 flex flex-col flex-grow">
                                <h3 class="text-2xl font-bold text-[#4a2c2a] mb-2">í•´í”¼</h3>
                                 <div class="flex flex-wrap gap-2 mb-4">
                                    <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">í‘¸ë“¤</span>
                                    <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">5ì‚´ ì¶”ì •</span>
                                    <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">ìˆ˜ì»·</span>
                                </div>
                                 <div class="bg-[#f0d8b6] p-3 rounded-lg mb-4">
                                     <p class="text-sm text-[#4a2c2a] font-semibold">ğŸ’¡ <strong>AI ì¶”ì²œ ì´ìœ :</strong> ë‹¤ë¥¸ ë°˜ë ¤ë™ë¬¼ê³¼ë„ ì˜ ì§€ë‚´ëŠ” ì‚¬êµì„±ì„ ê°€ì¡Œì–´ìš”. ìë…€ê°€ ìˆëŠ” ê°€ì •ì— í™œê¸°ë¥¼ ë¶ˆì–´ë„£ì–´ ì¤„ ë˜‘ë˜‘í•œ ì¹œêµ¬ëë‹ˆë‹¤.</p>
                                </div>
                                <button href="chatbot.html" class="w-full mt-auto bg-[#a9754f] hover:bg-[#7a574b] text-white font-bold py-2 px-4 rounded-full transition duration-300">ìì„¸íˆ ë³´ê¸°</button>
                            </div>
                        </div>
                    </div>
                    <div class="swiper-slide h-auto pb-4">
                        <div class="bg-white rounded-2xl overflow-hidden card-shadow transform hover:-translate-y-2 transition duration-300 h-full flex flex-col">
                            <img src="https://placedog.net/640/480/y" alt="ê°•ì•„ì§€ ì‚¬ì§„" class="w-full h-56 object-cover">
                            <div class="p-6 flex flex-col flex-grow">
                                <h3 class="text-2xl font-bold text-[#4a2c2a] mb-2">ë©”ë¦¬</h3>
                                 <div class="flex flex-wrap gap-2 mb-4">
                                    <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">ì§„ë—ê°œ</span>
                                    <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">3ì‚´ ì¶”ì •</span>
                                    <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">ì•”ì»·</span>
                                </div>
                                 <div class="bg-[#f0d8b6] p-3 rounded-lg mb-4">
                                     <p class="text-sm text-[#4a2c2a] font-semibold">ğŸ’¡ <strong>AI ì¶”ì²œ ì´ìœ :</strong> ë„“ì€ ë§ˆë‹¹ì´ ìˆëŠ” ì£¼íƒì—ì„œ ì¶©ë¶„íˆ í™œë™í•˜ë©° í–‰ë³µí•˜ê²Œ ì§€ë‚¼ ìˆ˜ ìˆëŠ” ë“¬ì§í•œ ì¹œêµ¬ë¥¼ ì°¾ê³  ê³„ì‹ ê°€ìš”?</p>
                                </div>
                                <button href="chatbot.html" class="w-full mt-auto bg-[#a9754f] hover:bg-[#7a574b] text-white font-bold py-2 px-4 rounded-full transition duration-300">ìì„¸íˆ ë³´ê¸°</button>
                            </div>
                        </div>
                    </div>
                    <div class="swiper-slide h-auto pb-4">
                        <div class="bg-white rounded-2xl overflow-hidden card-shadow transform hover:-translate-y-2 transition duration-300 h-full flex flex-col">
                           <img src="https://placedog.net/640/480/o" alt="ê°•ì•„ì§€ ì‚¬ì§„" class="w-full h-56 object-cover">
                            <div class="p-6 flex flex-col flex-grow">
                                <h3 class="text-2xl font-bold text-[#4a2c2a] mb-2">í† ë¦¬</h3>
                                 <div class="flex flex-wrap gap-2 mb-4">
                                    <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">ë§í‹°ì¦ˆ</span>
                                    <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">4ì‚´ ì¶”ì •</span>
                                    <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">ìˆ˜ì»·</span>
                                </div>
                                 <div class="bg-[#f0d8b6] p-3 rounded-lg mb-4">
                                     <p class="text-sm text-[#4a2c2a] font-semibold">ğŸ’¡ <strong>AI ì¶”ì²œ ì´ìœ :</strong> ì¡°ìš©í•˜ê³  ì‚¬ë‘ìŠ¤ëŸ¬ìš´ ì‹¤ë‚´ê²¬ì„ ì„ í˜¸í•˜ë©°, ë”°ëœ»í•œ ë³´ì‚´í•Œì„ ì£¼ì‹¤ ë¶„ì—ê²Œ ì™„ë²½í•œ íŒŒíŠ¸ë„ˆê°€ ë  ê±°ì˜ˆìš”.</p>
                                </div>
                                <button href="chatbot.html" class="w-full mt-auto bg-[#a9754f] hover:bg-[#7a574b] text-white font-bold py-2 px-4 rounded-full transition duration-300">ìì„¸íˆ ë³´ê¸°</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="swiper-button-next" ></div>
            <div class="swiper-button-prev"></div>
        </div>
    </main>

    <footer class="bg-[#7a574b] text-white py-8 rounded-t-3xl mt-16"></footer>

    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <script>
        const AI_BASE = '/ai'; // nginx proxies /ai -> ai-service
        function findField(infoArr, key){
            for (const row of infoArr){
                if (row[0] === key) return row[1] || '';
                if (row[2] === key) return row[3] || '';
            }
            return '';
        }

        function shuffle(arr){
            const a = arr.slice();
            for (let i = a.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [a[i], a[j]] = [a[j], a[i]];
            }
            return a;
        }

        async function loadAnimals(){
            const res = await fetch(`${AI_BASE}/animals`);
            let data = await res.json();
            // ì„ì–´ì„œ í‘œì‹œ (í•­ìƒ ê°™ì€ ì¹´ë“œë§Œ ë³´ì´ì§€ ì•Šë„ë¡)
            data = shuffle(data);

            // Top 3 ì˜ì—­ì„ ì‹¤ì œ ë°ì´í„°ë¡œ êµ¬ì„± (í˜„ì¬ëŠ” ìƒìœ„ 3ê°œ ë…¸ì¶œ)
            const top3Wrap = document.getElementById('top3');
            top3Wrap.innerHTML = '';
            data.slice(0, 3).forEach((item, idx) => {
                const name = findField(item.info, 'ì´ë¦„') || 'ì´ë¦„ ë¯¸ìƒ';
                const breed = findField(item.info, 'í’ˆì¢…') || 'í’ˆì¢… ë¯¸ìƒ';
                const age = findField(item.info, 'ë‚˜ì´(ì¶”ì •)') || '';
                const gender = findField(item.info, 'ì„±ë³„') || '';
                const img = item.thumbnail || (item.gallery && item.gallery[0]) || (item.images_mapped && item.images_mapped[0]) || (item.images && item.images[0]) || '';
                const rank = idx === 1 ? 1 : (idx === 0 ? 2 : 3);
                const badgeColor = rank === 1 ? 'bg-yellow-500' : (rank === 2 ? 'bg-slate-500' : 'bg-orange-700');
                const card = document.createElement('div');
                card.className = `flex-1 bg-white rounded-2xl overflow-hidden card-shadow transform hover:-translate-y-2 transition duration-300 flex flex-col ${idx===1 ? 'scale-105 z-10 order-1 md:order-2' : (idx===0 ? 'order-2 md:order-1' : 'order-3 md:order-3')}`;
                card.innerHTML = `
                    <div class="relative p-4">
                        <img src="${img}" alt="${name}" class="w-full h-48 object-cover bg-gray-50 rounded-lg" onerror="this.onerror=null; this.src='/assets/dog-placeholder.svg'">
                        <div class="absolute top-0 right-0 mt-3 mr-3 ${badgeColor} text-white w-10 h-10 rounded-full flex items-center justify-center font-bold text-xl shadow-lg">${rank}</div>
                    </div>
                    <div class="p-6 flex flex-col flex-grow text-center">
                        <h3 class="text-2xl font-bold text-[#4a2c2a]">${name}</h3>
                        <div class="flex flex-wrap gap-2 my-3 justify-center">
                            <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">${breed}</span>
                            ${age?`<span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">${age}</span>`:''}
                            ${gender?`<span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">${gender}</span>`:''}
                        </div>
                        <button data-id="${item.id}" class="detail-btn w-full mt-auto bg-[#a9754f] hover:bg-[#7a574b] text-white font-bold py-2 px-4 rounded-full transition duration-300">ìì„¸íˆ ë³´ê¸°</button>
                    </div>
                `;
                top3Wrap.appendChild(card);
            });
            top3Wrap.querySelectorAll('.detail-btn').forEach(btn => {
                btn.addEventListener('click', (e)=>{
                    const id = e.currentTarget.getAttribute('data-id');
                    window.location.href = `/chatbot.html?id=${id}`;
                });
            });
            const wrapper = document.getElementById('animal-swiper-wrapper');
            wrapper.innerHTML = '';
            // ìºëŸ¬ì…€ë„ ì„ì¸ ìˆœì„œëŒ€ë¡œ
            data.forEach((item)=>{
                const name = findField(item.info, 'ì´ë¦„') || 'ì´ë¦„ ë¯¸ìƒ';
                const breed = findField(item.info, 'í’ˆì¢…') || 'í’ˆì¢… ë¯¸ìƒ';
                const age = findField(item.info, 'ë‚˜ì´(ì¶”ì •)') || '';
                const gender = findField(item.info, 'ì„±ë³„') || '';
                const img = item.thumbnail || (item.gallery && item.gallery[0]) || (item.images_mapped && item.images_mapped[0]) || (item.images && item.images[0]) || '';
                const slide = document.createElement('div');
                slide.className = 'swiper-slide h-auto pb-4';
                slide.innerHTML = `
                    <div class="bg-white rounded-2xl overflow-hidden card-shadow transform hover:-translate-y-2 transition duration-300 h-full flex flex-col">
                        <img src="${img}" alt="ê°•ì•„ì§€ ì‚¬ì§„" class="w-full h-56 object-cover" onerror="this.onerror=null; this.src='/assets/dog-placeholder.svg'">
                        <div class="p-6 flex flex-col flex-grow">
                            <h3 class="text-2xl font-bold text-[#4a2c2a] mb-2">${name}</h3>
                            <div class="flex flex-wrap gap-2 mb-4">
                                <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">${breed}</span>
                                <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">${age}</span>
                                <span class="bg-gray-200 text-gray-800 text-xs font-semibold px-2.5 py-0.5 rounded-full">${gender}</span>
                            </div>
                            <button data-id="${item.id}" class="detail-btn w-full mt-auto bg-[#a9754f] hover:bg-[#7a574b] text-white font-bold py-2 px-4 rounded-full transition duration-300">ìì„¸íˆ ë³´ê¸°</button>
                        </div>
                    </div>`;
                wrapper.appendChild(slide);
            });
            wrapper.querySelectorAll('.detail-btn').forEach(btn => {
                btn.addEventListener('click', (e)=>{
                    const id = e.currentTarget.getAttribute('data-id');
                    window.location.href = `/chatbot.html?id=${id}`;
                });
            });
            new Swiper('.swiper', {
                slidesPerView: 1,
                spaceBetween: 30,
                breakpoints: { 768: { slidesPerView: 2, spaceBetween: 30 }, 1024: { slidesPerView: 3, spaceBetween: 30 } },
                loop: true,
                navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' }
            });
        }

        document.addEventListener('DOMContentLoaded', loadAnimals);
    </script>
</body>
</html>